{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, onUnmounted, ref, unref } from \"vue\";\nexport const useScrollLoad = (target, url) => {\n  const size = 10;\n  const list = ref([]);\n  const start = ref(0);\n  const load = () => {\n    fetchData();\n  };\n  const loadMore = () => {\n    start.value = start.value + size;\n    load();\n  };\n  const fetchData = () => {\n    fetch(url(start.value, size)).then(res => res.json()).then(res => {\n      list.value.push(...res);\n    });\n  };\n  const getScrollRest = element => {\n    const clientHeight = element.clientHeight;\n    const scrollHeight = element.scrollHeight;\n    const scrollTop = element.scrollTop;\n    return scrollHeight - scrollTop - clientHeight;\n  };\n  const handleScrollEvent = e => {\n    const bottom = getScrollRest(e.target);\n    if (bottom === 0) {\n      loadMore();\n    }\n  };\n  onMounted(() => {\n    if (!target.value) {\n      return;\n    }\n    load();\n    target.value.addEventListener(\"scroll\", handleScrollEvent);\n  });\n  onUnmounted(() => {\n    if (!target.value) {\n      return;\n    }\n    target.value.removeEventListener(\"scroll\", handleScrollEvent);\n  });\n  return {\n    list\n  };\n};","map":{"version":3,"names":["onMounted","onUnmounted","ref","unref","useScrollLoad","target","url","size","list","start","load","fetchData","loadMore","value","fetch","then","res","json","push","getScrollRest","element","clientHeight","scrollHeight","scrollTop","handleScrollEvent","e","bottom","addEventListener","removeEventListener"],"sources":["C:/test/test/test/src/common/scrollLoad.js"],"sourcesContent":["import { onMounted, onUnmounted, ref, unref } from \"vue\";\r\n\r\nexport const useScrollLoad = (target, url) => {\r\n  const size = 10;\r\n\r\n  const list = ref([]);\r\n  const start = ref(0);\r\n\r\n  const load = () => {\r\n    fetchData();\r\n  };\r\n\r\n  const loadMore = () => {\r\n    start.value = start.value + size;\r\n    load();\r\n  };\r\n\r\n  const fetchData = () => {\r\n    fetch(url(start.value, size))\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        list.value.push(...res);\r\n      });\r\n  };\r\n\r\n  const getScrollRest = (element) => {\r\n    const clientHeight = element.clientHeight;\r\n    const scrollHeight = element.scrollHeight;\r\n    const scrollTop = element.scrollTop;\r\n\r\n    return scrollHeight - scrollTop - clientHeight;\r\n  };\r\n\r\n  const handleScrollEvent = (e) => {\r\n    const bottom = getScrollRest(e.target);\r\n\r\n    if (bottom === 0) {\r\n      loadMore();\r\n    }\r\n  };\r\n\r\n  onMounted(() => {\r\n    if (!target.value) {\r\n      return;\r\n    }\r\n\r\n    load();\r\n    target.value.addEventListener(\"scroll\", handleScrollEvent);\r\n  });\r\n\r\n  onUnmounted(() => {\r\n    if (!target.value) {\r\n      return;\r\n    }\r\n    target.value.removeEventListener(\"scroll\", handleScrollEvent);\r\n  });\r\n\r\n  return { list };\r\n};"],"mappings":";AAAA,SAASA,SAAS,EAAEC,WAAW,EAAEC,GAAG,EAAEC,KAAK,QAAQ,KAAK;AAExD,OAAO,MAAMC,aAAa,GAAGA,CAACC,MAAM,EAAEC,GAAG,KAAK;EAC5C,MAAMC,IAAI,GAAG,EAAE;EAEf,MAAMC,IAAI,GAAGN,GAAG,CAAC,EAAE,CAAC;EACpB,MAAMO,KAAK,GAAGP,GAAG,CAAC,CAAC,CAAC;EAEpB,MAAMQ,IAAI,GAAGA,CAAA,KAAM;IACjBC,SAAS,CAAC,CAAC;EACb,CAAC;EAED,MAAMC,QAAQ,GAAGA,CAAA,KAAM;IACrBH,KAAK,CAACI,KAAK,GAAGJ,KAAK,CAACI,KAAK,GAAGN,IAAI;IAChCG,IAAI,CAAC,CAAC;EACR,CAAC;EAED,MAAMC,SAAS,GAAGA,CAAA,KAAM;IACtBG,KAAK,CAACR,GAAG,CAACG,KAAK,CAACI,KAAK,EAAEN,IAAI,CAAC,CAAC,CAC1BQ,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEC,GAAG,IAAK;MACbR,IAAI,CAACK,KAAK,CAACK,IAAI,CAAC,GAAGF,GAAG,CAAC;IACzB,CAAC,CAAC;EACN,CAAC;EAED,MAAMG,aAAa,GAAIC,OAAO,IAAK;IACjC,MAAMC,YAAY,GAAGD,OAAO,CAACC,YAAY;IACzC,MAAMC,YAAY,GAAGF,OAAO,CAACE,YAAY;IACzC,MAAMC,SAAS,GAAGH,OAAO,CAACG,SAAS;IAEnC,OAAOD,YAAY,GAAGC,SAAS,GAAGF,YAAY;EAChD,CAAC;EAED,MAAMG,iBAAiB,GAAIC,CAAC,IAAK;IAC/B,MAAMC,MAAM,GAAGP,aAAa,CAACM,CAAC,CAACpB,MAAM,CAAC;IAEtC,IAAIqB,MAAM,KAAK,CAAC,EAAE;MAChBd,QAAQ,CAAC,CAAC;IACZ;EACF,CAAC;EAEDZ,SAAS,CAAC,MAAM;IACd,IAAI,CAACK,MAAM,CAACQ,KAAK,EAAE;MACjB;IACF;IAEAH,IAAI,CAAC,CAAC;IACNL,MAAM,CAACQ,KAAK,CAACc,gBAAgB,CAAC,QAAQ,EAAEH,iBAAiB,CAAC;EAC5D,CAAC,CAAC;EAEFvB,WAAW,CAAC,MAAM;IAChB,IAAI,CAACI,MAAM,CAACQ,KAAK,EAAE;MACjB;IACF;IACAR,MAAM,CAACQ,KAAK,CAACe,mBAAmB,CAAC,QAAQ,EAAEJ,iBAAiB,CAAC;EAC/D,CAAC,CAAC;EAEF,OAAO;IAAEhB;EAAK,CAAC;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}